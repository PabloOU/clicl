;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; factserver.test;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; reset;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(reset)*(defparameter *factserver* (make-instance 'factserver :name 'factserver))*;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; revise, errors, revisions, notifications, reactions;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(revisions '(p a) *factserver*)((P A))(revisions '(q a) *factserver*)((Q A))(revisions '(and (not (p b)) (q b)) *factserver*)((NOT (P B)) (Q B))(revisions '(<= (r ?x) (p ?x) (q ?x)) *factserver*)((<= (R ?X) (P ?X) (Q ?X)))(reset)*;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; askp, askx, asks;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Integers;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(integer 2) nil *factserver*)t(askp '(integer 1/2) nil *factserver*)nil(askp '(integer 3.2) nil *factserver*)nil(askp '(integer #c(1 2)) nil *factserver*)nil(askp '(integer a) nil *factserver*)nil(askp '(even 2) nil *factserver*)t(askp '(even a) nil *factserver*)nil(askp '(odd 3) nil *factserver*)t(askp '(odd a) nil *factserver*)nil(askp '(positive 3) nil *factserver*)t(askp '(positive a) nil *factserver*)nil(askp '(negative -1) nil *factserver*)t(askp '(negative a) nil *factserver*)nil(askp '(zero 0) nil *factserver*)t(askp '(gcd 2 6 2) nil *factserver*)t(askp '(lcm 2 3 6) nil *factserver*)t(askp '(isqrt 5 2) nil *factserver*)t(askp '(mod 7 2 1) nil *factserver*)t(askp '(rem 3 2 1) nil *factserver*)t(askp '(ash 1 1 2) nil *factserver*)t(askp '(boole 6 1 1 1) nil *factserver*)t(askp '(logbit 2 6) nil *factserver*)t(askp '(logand 1 1 1) nil *factserver*)t(askp '(logandc1 0 1 1) nil *factserver*)t(askp '(logandc2 1 0 1) nil *factserver*)t(askp '(logcount 3 2) nil *factserver*)t(askp '(logeqv 1 1 -1) nil *factserver*)t(askp '(logior 1 1 1) nil *factserver*)t(askp '(lognand 0 1 -1) nil *factserver*)t(askp '(lognor 0 0 -1) nil *factserver*)t(askp '(lognot -4 3) nil *factserver*)t(askp '(logorc1 0 0 -1) nil *factserver*)t(askp '(logorc2 0 0 -1) nil *factserver*)t(askp '(logxor 0 1 1) nil *factserver*)t(askp '(zero a) nil *factserver*)nil(askp '(logbit 0 6) nil *factserver*)nil(askp '(logtest 2 6) nil *factserver*)t(askp '(logtest 2 -3) nil *factserver*)nil;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Rationals;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(rationalnumber 1) nil *factserver*)t(askp '(rationalnumber 1/2) nil *factserver*)t(askp '(rationalnumber 3.2) nil *factserver*)nil(askp '(rationalnumber #c(1 2)) nil *factserver*)nil(askp '(rationalnumber a) nil *factserver*)nil(askp '(numerator 1/2 1) nil *factserver*)t(askp '(denominator 1/2 2) nil *factserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Reals;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(realnumber 1) nil *factserver*)t(askp '(realnumber 1/2) nil *factserver*)t(askp '(realnumber 3.2) nil *factserver*)t(askp '(realnumber #c(1 2)) nil *factserver*)nil(askp '(realnumber a) nil *factserver*)nil(askp '(< 2 3) nil *factserver*)t(askp '(< 3 3) nil *factserver*)nil(askp '(< a b) nil *factserver*)nil(askp '(=< 2 3) nil *factserver*)t(askp '(=< 3 2) nil *factserver*)nil(askp '(=< a b) nil *factserver*)nil(askp '(> 3 2) nil *factserver*)t(askp '(> 3 3) nil *factserver*)nil(askp '(> a b) nil *factserver*)nil(askp '(>= 3 2) nil *factserver*)t(askp '(>= 2 3) nil *factserver*)nil(askp '(>= a b) nil *factserver*)nil(askp '(+ 1 2 3) nil *factserver*)t(askp '(- 3 2 1) nil *factserver*)t(askp '(* 2 3 6) nil *factserver*)t(askp '(/ 4 2 2) nil *factserver*)t(askp '(1+ 1 2) nil *factserver*)t(askp '(1- 2 1) nil *factserver*)t(askp '(abs -1 1) nil *factserver*)t(askp '(exp 0 1) nil *factserver*)t(askp '(expt 2 3 8) nil *factserver*)t(askp '(log 8 2 3) nil *factserver*)t(askp '(sqrt 4 2) nil *factserver*)t(askp '(max 1 2 3 3) nil *factserver*)t(askp '(min 1 2 3 1) nil *factserver*)t(askp '(signum 23 1) nil *factserver*)t(askp '(acos 1 0) nil *factserver*)t(askp '(acosh 1 0) nil *factserver*)t(askp '(asin 0 0) nil *factserver*)t(askp '(asinh 0 0) nil *factserver*)t(askp '(atan 0 0) nil *factserver*)t(askp '(atanh 0 0) nil *factserver*)t(askp '(cos 0 1) nil *factserver*)t(askp '(cosh 0 1) nil *factserver*)t(askp '(sin 0 0) nil *factserver*)t(askp '(sinh 0 0) nil *factserver*)t(askp '(tan 0 0) nil *factserver*)t(askp '(tanh 0 0) nil *factserver*)t(askp '(ceiling 1.6 2) nil *factserver*)t(askp '(floor 1.6 1) nil *factserver*)t(askp '(round 1.6 2) nil *factserver*)t(askp '(truncate 1.6 1) nil *factserver*)t(askp '(rationalize 0.5 1/2) nil *factserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Complexes;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(complexnumber 1) nil *factserver*)nil ;;; t?(askp '(complexnumber 1/2) nil *factserver*)nil ;;; t?(askp '(complexnumber 3.2) nil *factserver*)nil ;;; t?(askp '(complexnumber #c(1 2)) nil *factserver*)t(askp '(complexnumber a) nil *factserver*)nil(askp '(conjugate #c(1 1) #c(1 -1)) nil *factserver*)t(askp '(complex 1 1 #c(1 1)) nil *factserver*)t(askp '(realpart #c(1 2) 1) nil *factserver*)t(askp '(imagpart #c(1 2) 2) nil *factserver*)t(askp '(cis 0 #c(1 0)) nil *factserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Numbers;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(number 1) nil *factserver*)t(askp '(number 1/2) nil *factserver*)t(askp '(number 3.2) nil *factserver*)t(askp '(number #c(1 2)) nil *factserver*)t(askp '(number a) nil *factserver*)nil;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Characters;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(character #\a) nil *factserver*)t(askp '(character "a") nil *factserver*)nil(askp '(character a) nil *factserver*)nil(askp '(alphabetic #\a) nil *factserver*)t(askp '(alphabetic #\1) nil *factserver*)nil(askp '(uppercase #\A) nil *factserver*)t(askp '(uppercase #\a) nil *factserver*)nil(askp '(lowercase #\a) nil *factserver*)t(askp '(lowercase #\A) nil *factserver*)nil(askp '(digit #\1) nil *factserver*)t(askp '(digit #\a) nil *factserver*)nil(askp '(alphanumeric #\a) nil *factserver*)t(askp '(alphanumeric #\1) nil *factserver*)t(askp '(alphanumeric #\.) nil *factserver*)nil(askp '(chargreater #\b #\a) nil *factserver*)t(askp '(chargreater #\a #\b) nil *factserver*)nil(askp '(charless #\a #\b) nil *factserver*)t(askp '(charless #\b #\a) nil *factserver*)nil(askp '(charupcase #\a #\A) nil *factserver*)t(askp '(chardowncase #\A #\a) nil *factserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Strings;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(string #\a) nil *factserver*)nil(askp '(string "a") nil *factserver*)t(askp '(string a) nil *factserver*)nil(askp '(stringgreater "bbc" "abc") nil *factserver*)t(askp '(stringgreater "abc" "bbc") nil *factserver*)nil(askp '(stringless "abc" "bbc") nil *factserver*)t(askp '(stringless "bbc" "abc") nil *factserver*)nil(askp '(substring "bc" "abcd") nil *factserver*)t(askp '(substring "abcd" "ab") nil *factserver*)nil(askp '(stringlength "abc" 3) nil *factserver*)t(askp '(stringelement "abc" 2 #\b) nil *factserver*)t(askp '(stringsubseq "abcd" 2 3 "bc") nil *factserver*)t(askp '(stringalphanumeric " a bc'd-e " "abcde") nil *factserver*)t(askp '(stringappend "abc" "def" "ghi" "abcdefghi") nil *factserver*)t(askp '(stringappend "" "") nil *factserver*)t(askp '(stringcharpos #\b "abc" 2) nil *factserver*)t(askx '?x '(stringcharpos #\d "abc" ?x) nil *factserver*)nil(askp '(stringposition "bc" "abcd" 2) nil *factserver*)t(askx '?x '(stringposition "cb" "abcd" ?x) nil *factserver*)nil(askp '(stringsubstitute #\a #\b "abab" "aaaa") nil *factserver*)t(askp '(stringupcase "abc" "ABC") nil *factserver*)t(askp '(stringdowncase "ABC" "abc") nil *factserver*)t(askp '(stringcapitalize "abc.def" "Abc.Def") nil *factserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Conversion;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(charstring #\a "a") nil *factserver*)t(askp '(stringify a "A") nil *factserver*)t(askp '(symbolize "a" a) nil *factserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Miscellaneous;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(word 'a) nil *factserver*)t(askp '(word a) nil *factserver*)nil(askp '(indvar '?x) nil *factserver*)t(askp '(indvar a) nil *factserver*)nil(askp '(seqvar '@l) nil *factserver*)t(askp '(seqvar a) nil *factserver*)nil(askp '(variable '?x) nil *factserver*)t(askp '(variable '@l) nil *factserver*)t(askp '(variable a) nil *factserver*)nil(askp '(same a a) nil *factserver*)t(askp '(same a b) nil *factserver*)nil(askp '(distinct a a) nil *factserver*)nil(askp '(distinct a b) nil *factserver*)t(askp '(oneof b a b c) nil *factserver*)t(askp '(oneof d a b c) nil *factserver*)nil(askp '(choose ?x (oneof ?x a b c) a) nil *factserver*)t(askp '(choose ?x (oneof ?x a b c) b) nil *factserver*)nil(askp '(bagofall ?x (oneof ?x a b c) (listof a b c)) nil *factserver*)t(askp '(bagofall ?x (oneof ?x a b c) (listof a)) nil *factserver*)nil(askp '(ground a) nil *factserver*)t(askp '(ground ?x) nil *factserver*)nil(askp '(nonground a) nil *factserver*)nil(askp '(nonground ?x) nil *factserver*)t(askp '(execute (member 'b '(a b c)) '(b c)) nil *factserver*)t(askp '(evaluate (member b (a b c)) (b c)) nil *factserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Logic;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp 'true nil *factserver*)t(askp 'false nil *factserver*)nil(askp '(not true) nil *factserver*)nil(askp '(not false) nil *factserver*)t(askp '(and true true) nil *factserver*)t(askp '(and true false) nil *factserver*)nil(askp '(and false true) nil *factserver*)nil(askp '(and false false) nil *factserver*)nil(askp '(or true true) nil *factserver*)t(askp '(or true false) nil *factserver*)t(askp '(or false true) nil *factserver*)t(askp '(or false false) nil *factserver*)nil;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Inference;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(define-theory *factserver* ""  '((p a)    (p b)    (p c)    (q b)    (q c)))*(askp '(and (p b) (q b)) nil *factserver*)t(askp '(or (p a) (q a)) nil *factserver*)t(askx '?x '(and (p ?x) (q ?x)) nil *factserver*)b(askx '?x '(or (p ?x) (q ?x)) nil *factserver*)a(asks '?x '(and (p ?x) (q ?x)) nil *factserver*)(b c)(asks '?x '(or (p ?x) (q ?x)) nil *factserver*)(a b c)(define-theory *factserver* ""  '((pp a a)    (pp a b)    (qq b c)))*(askp '(and (pp a b) (qq b c)) nil *factserver*)t(askx '(?x ?y ?z) '(and (pp ?x ?y) (qq ?y ?z)) nil *factserver*)(a b c)(asks '(?x ?y ?z) '(and (pp ?x ?y) (qq ?y ?z)) nil *factserver*)((a b c))(reset)*;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;