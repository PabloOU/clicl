;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; integrator.test;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; resetsystem;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(resetsystem)*;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; revise, revisions;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(definemore *manager*  '((extension myintegrator p)    (extension myintegrator q)    (material  myintegrator r)    (specialty repository p)    (specialty repository q)    (interest  mrg        p)    (interest  mrg        r)))*(definemore *repository*  '((p a b)    (p b b)    (q b b)))*(define-theory *library* ""  '((<= (r ?x ?y) (p ?x ?y) (q ?x ?y))    (<= (s ?x ?y) (p ?x ?y))    (<= (s ?x ?y) (q ?x ?y))    (<= (t ?x ?z) (p ?x ?y) (q ?y ?z))        (<= (pos (r ?x ?y)) (p ?x ?y) (not (neg (p ?x ?y))) (pos (q ?x ?y)))    (<= (pos (r ?x ?y)) (pos (p ?x ?y)) (q ?x ?y) (not (neg (q ?x ?y))))    (<= (pos (r ?x ?y)) (pos (p ?x ?y)) (pos (q ?x ?y)))    (<= (neg (r ?x ?y)) (neg (p ?x ?y)))    (<= (neg (r ?x ?y)) (neg (q ?x ?y)))    (<= (pos (s ?x ?y)) (pos (p ?x ?y)) (not (q ?x ?y)))    (<= (pos (s ?x ?y)) (pos (q ?x ?y)) (not (p ?x ?y)))    (<= (neg (s ?x ?y)) (neg (p ?x ?y)) (not (q ?x ?y)))    (<= (neg (s ?x ?y)) (neg (q ?x ?y)) (not (p ?x ?y)))    (<= (neg (s ?x ?y)) (neg (p ?x ?y)) (neg (q ?x ?y)))    (<= (plus (p ?x ?y)) (plus (r ?x ?y)))    (<= (plus (q ?x ?y)) (plus (r ?x ?y)))    (<= (minus (p ?x ?y)) (minus (r ?x ?y)) (q ?x ?y))    (<= (plus (p ?x ?y)) (plus (s ?x ?y)))    (<= (minus (p ?x ?y)) (minus (s ?x ?y)) (p ?x ?y))    (<= (minus (q ?x ?y)) (minus (s ?x ?y)) (q ?x ?y))    (<= (plus (p ?x b)) (plus (t ?x ?z)))    (<= (plus (q b ?z)) (plus (t ?x ?z)))    (<= (minus (p ?x ?y)) (minus (t ?x ?z)) (q ?y ?z))    (<= (minus (q ?y ?z)) (minus (t ?x ?z)) (p ?x ?y))    (<= (trigger (print (kwote ?x))) (pos (p ?x ?y)) (pos (q ?x ?y)))    (<= (error "P is a function.") (p ?x ?y) (not (neg (p ?x ?y))) (pos (p ?x ?z)) (distinct ?y ?z))    (<= (error "P is a function.") (pos (p ?x ?y)) (pos (p ?x ?z)) (distinct ?y ?z))))*(revisions '(p a c) *myintegrator*)((P A C))(revisions '(not (p b b)) *myintegrator*)((NOT (P B B)))(revisions '(and (not (p b b)) (q a b)) *myintegrator*)((NOT (P B B)) (Q A B))(revisions '(r a c) *myintegrator*)((P A C) (Q A C))(revisions '(s a c) *myintegrator*)((P A C))(revisions '(t a c) *myintegrator*)((P A B) (Q B C))(errors '(p a c) *myintegrator*)("P is a function.")(errors '(and (not (p a b)) (p a c)) *myintegrator*)NIL(materializations '(and (not (p b b)) (q a b)) *myintegrator*)((NOT (R B B)) (R A B))(notifications '(and (not (p b b)) (q a b)) *myintegrator*)((MRG (NOT (P B B)) (NOT (R B B)) (R A B)))(reactions '(and (p a c) (q a c)) *myintegrator*)((PRINT (KWOTE A)))(resetsystem)*;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Integers;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(integer 2) nil *myintegrator*)t(askp '(integer 1/2) nil *myintegrator*)nil(askp '(integer 3.2) nil *myintegrator*)nil(askp '(integer #c(1 2)) nil *myintegrator*)nil(askp '(integer a) nil *myintegrator*)nil(askp '(even 2) nil *myintegrator*)t(askp '(even a) nil *myintegrator*)nil(askp '(odd 3) nil *myintegrator*)t(askp '(odd a) nil *myintegrator*)nil(askp '(positive 3) nil *myintegrator*)t(askp '(positive a) nil *myintegrator*)nil(askp '(negative -1) nil *myintegrator*)t(askp '(negative a) nil *myintegrator*)nil(askp '(zero 0) nil *myintegrator*)t(askp '(gcd 2 6 2) nil *myintegrator*)t(askp '(lcm 2 3 6) nil *myintegrator*)t(askp '(isqrt 5 2) nil *myintegrator*)t(askp '(mod 7 2 1) nil *myintegrator*)t(askp '(rem 3 2 1) nil *myintegrator*)t(askp '(ash 1 1 2) nil *myintegrator*)t(askp '(boole 6 1 1 1) nil *myintegrator*)t(askp '(logbit 2 6) nil *myintegrator*)t(askp '(logand 1 1 1) nil *myintegrator*)t(askp '(logandc1 0 1 1) nil *myintegrator*)t(askp '(logandc2 1 0 1) nil *myintegrator*)t(askp '(logcount 3 2) nil *myintegrator*)t(askp '(logeqv 1 1 -1) nil *myintegrator*)t(askp '(logior 1 1 1) nil *myintegrator*)t(askp '(lognand 0 1 -1) nil *myintegrator*)t(askp '(lognor 0 0 -1) nil *myintegrator*)t(askp '(lognot -4 3) nil *myintegrator*)t(askp '(logorc1 0 0 -1) nil *myintegrator*)t(askp '(logorc2 0 0 -1) nil *myintegrator*)t(askp '(logxor 0 1 1) nil *myintegrator*)t(askp '(zero a) nil *myintegrator*)nil(askp '(logbit 0 6) nil *myintegrator*)nil(askp '(logtest 2 6) nil *myintegrator*)t(askp '(logtest 2 -3) nil *myintegrator*)nil;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Rationals;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(rationalnumber 1) nil *myintegrator*)t(askp '(rationalnumber 1/2) nil *myintegrator*)t(askp '(rationalnumber 3.2) nil *myintegrator*)nil(askp '(rationalnumber #c(1 2)) nil *myintegrator*)nil(askp '(rationalnumber a) nil *myintegrator*)nil(askp '(numerator 1/2 1) nil *myintegrator*)t(askp '(denominator 1/2 2) nil *myintegrator*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Reals;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(realnumber 1) nil *myintegrator*)t(askp '(realnumber 1/2) nil *myintegrator*)t(askp '(realnumber 3.2) nil *myintegrator*)t(askp '(realnumber #c(1 2)) nil *myintegrator*)nil(askp '(realnumber a) nil *myintegrator*)nil(askp '(< 2 3) nil *myintegrator*)t(askp '(< 3 3) nil *myintegrator*)nil(askp '(< a b) nil *myintegrator*)nil(askp '(=< 2 3) nil *myintegrator*)t(askp '(=< 3 2) nil *myintegrator*)nil(askp '(=< a b) nil *myintegrator*)nil(askp '(> 3 2) nil *myintegrator*)t(askp '(> 3 3) nil *myintegrator*)nil(askp '(> a b) nil *myintegrator*)nil(askp '(>= 3 2) nil *myintegrator*)t(askp '(>= 2 3) nil *myintegrator*)nil(askp '(>= a b) nil *myintegrator*)nil(askp '(+ 1 2 3) nil *myintegrator*)t(askp '(- 3 2 1) nil *myintegrator*)t(askp '(* 2 3 6) nil *myintegrator*)t(askp '(/ 4 2 2) nil *myintegrator*)t(askp '(1+ 1 2) nil *myintegrator*)t(askp '(1- 2 1) nil *myintegrator*)t(askp '(abs -1 1) nil *myintegrator*)t(askp '(exp 0 1) nil *myintegrator*)t(askp '(expt 2 3 8) nil *myintegrator*)t(askp '(log 8 2 3) nil *myintegrator*)t(askp '(sqrt 4 2) nil *myintegrator*)t(askp '(max 1 2 3 3) nil *myintegrator*)t(askp '(min 1 2 3 1) nil *myintegrator*)t(askp '(signum 23 1) nil *myintegrator*)t(askp '(acos 1 0) nil *myintegrator*)t(askp '(acosh 1 0) nil *myintegrator*)t(askp '(asin 0 0) nil *myintegrator*)t(askp '(asinh 0 0) nil *myintegrator*)t(askp '(atan 0 0) nil *myintegrator*)t(askp '(atanh 0 0) nil *myintegrator*)t(askp '(cos 0 1) nil *myintegrator*)t(askp '(cosh 0 1) nil *myintegrator*)t(askp '(sin 0 0) nil *myintegrator*)t(askp '(sinh 0 0) nil *myintegrator*)t(askp '(tan 0 0) nil *myintegrator*)t(askp '(tanh 0 0) nil *myintegrator*)t(askp '(ceiling 1.6 2) nil *myintegrator*)t(askp '(floor 1.6 1) nil *myintegrator*)t(askp '(round 1.6 2) nil *myintegrator*)t(askp '(truncate 1.6 1) nil *myintegrator*)t(askp '(rationalize 0.5 1/2) nil *myintegrator*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Complexes;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(complexnumber 1) nil *myintegrator*)nil ;;; t?(askp '(complexnumber 1/2) nil *myintegrator*)nil ;;; t?(askp '(complexnumber 3.2) nil *myintegrator*)nil ;;; t?(askp '(complexnumber #c(1 2)) nil *myintegrator*)t(askp '(complexnumber a) nil *myintegrator*)nil(askp '(conjugate #c(1 1) #c(1 -1)) nil *myintegrator*)t(askp '(complex 1 1 #c(1 1)) nil *myintegrator*)t(askp '(realpart #c(1 2) 1) nil *myintegrator*)t(askp '(imagpart #c(1 2) 2) nil *myintegrator*)t(askp '(cis 0 #c(1 0)) nil *myintegrator*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Numbers;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(number 1) nil *myintegrator*)t(askp '(number 1/2) nil *myintegrator*)t(askp '(number 3.2) nil *myintegrator*)t(askp '(number #c(1 2)) nil *myintegrator*)t(askp '(number a) nil *myintegrator*)nil;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Characters;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(character #\a) nil *myintegrator*)t(askp '(character "a") nil *myintegrator*)nil(askp '(character a) nil *myintegrator*)nil(askp '(alphabetic #\a) nil *myintegrator*)t(askp '(alphabetic #\1) nil *myintegrator*)nil(askp '(uppercase #\A) nil *myintegrator*)t(askp '(uppercase #\a) nil *myintegrator*)nil(askp '(lowercase #\a) nil *myintegrator*)t(askp '(lowercase #\A) nil *myintegrator*)nil(askp '(digit #\1) nil *myintegrator*)t(askp '(digit #\a) nil *myintegrator*)nil(askp '(alphanumeric #\a) nil *myintegrator*)t(askp '(alphanumeric #\1) nil *myintegrator*)t(askp '(alphanumeric #\.) nil *myintegrator*)nil(askp '(chargreater #\b #\a) nil *myintegrator*)t(askp '(chargreater #\a #\b) nil *myintegrator*)nil(askp '(charless #\a #\b) nil *myintegrator*)t(askp '(charless #\b #\a) nil *myintegrator*)nil(askp '(charupcase #\a #\A) nil *myintegrator*)t(askp '(chardowncase #\A #\a) nil *myintegrator*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Strings;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(string #\a) nil *myintegrator*)nil(askp '(string "a") nil *myintegrator*)t(askp '(string a) nil *myintegrator*)nil(askp '(stringgreater "bbc" "abc") nil *myintegrator*)t(askp '(stringgreater "abc" "bbc") nil *myintegrator*)nil(askp '(stringless "abc" "bbc") nil *myintegrator*)t(askp '(stringless "bbc" "abc") nil *myintegrator*)nil(askp '(substring "bc" "abcd") nil *myintegrator*)t(askp '(substring "abcd" "ab") nil *myintegrator*)nil(askp '(stringlength "abc" 3) nil *myintegrator*)t(askp '(stringelement "abc" 2 #\b) nil *myintegrator*)t(askp '(stringsubseq "abcd" 2 3 "bc") nil *myintegrator*)t(askp '(stringalphanumeric " a bc'd-e " "abcde") nil *myintegrator*)t(askp '(stringappend "abc" "def" "ghi" "abcdefghi") nil *myintegrator*)t(askp '(stringappend "" "") nil *myintegrator*)t(askp '(stringcharpos #\b "abc" 2) nil *myintegrator*)t(askp '(stringcharpos #\d "abc" ?x) nil *myintegrator*)nil(askp '(stringposition "bc" "abcd" 2) nil *myintegrator*)t(askp '(stringposition "cb" "abcd" ?x) nil *myintegrator*)nil(askp '(stringsubstitute #\a #\b "abab" "aaaa") nil *myintegrator*)t(askp '(stringupcase "abc" "ABC") nil *myintegrator*)t(askp '(stringdowncase "ABC" "abc") nil *myintegrator*)t(askp '(stringcapitalize "abc.def" "Abc.Def") nil *myintegrator*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Conversion;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(charstring #\a "a") nil *myintegrator*)t(askp '(stringify a "A") nil *myintegrator*)t(askp '(symbolize "a" a) nil *myintegrator*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Miscellaneous;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(same a a) nil *myintegrator*)t(askp '(same a b) nil *myintegrator*)nil(askp '(distinct a a) nil *myintegrator*)nil(askp '(distinct a b) nil *myintegrator*)t(askp '(word 'a) nil *myintegrator*)t(askp '(word a) nil *myintegrator*)nil(askp '(indvar '?x) nil *myintegrator*)t(askp '(indvar a) nil *myintegrator*)nil(askp '(seqvar '@l) nil *myintegrator*)t(askp '(seqvar a) nil *myintegrator*)nil(askp '(variable '?x) nil *myintegrator*)t(askp '(variable '@l) nil *myintegrator*)t(askp '(variable a) nil *myintegrator*)nil(askp '(execute (member 'b '(a b c)) '(b c)) nil *myintegrator*)t(askp '(evaluate (member b (a b c)) (b c)) nil *myintegrator*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Logic;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp 'true nil *myintegrator*)t(askp 'false nil *myintegrator*)nil(askp '(not true) nil *myintegrator*)nil(askp '(not false) nil *myintegrator*)t(askp '(and true true) nil *myintegrator*)t(askp '(and true false) nil *myintegrator*)nil(askp '(and false true) nil *myintegrator*)nil(askp '(and false false) nil *myintegrator*)nil(askp '(or true true) nil *myintegrator*)t(askp '(or true false) nil *myintegrator*)t(askp '(or false true) nil *myintegrator*)t(askp '(or false false) nil *myintegrator*)nil;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Inference;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(definemore *manager*  '((specialty repository p)    (specialty repository q)))*(definemore *library*  '((<= (r ?x) (p ?x) (q ?x))))*(define-theory *repository* ""  '((p a)    (p b)    (p c)    (q b)    (q c)))*(askx '?x '(and (p ?x) (q ?x)) nil *myintegrator*)b(asks '?x '(and (p ?x) (q ?x)) nil *myintegrator*)(b c)(askx '?x '(or (p ?x) (q ?x)) nil *myintegrator*)a(asks '?x '(or (p ?x) (q ?x)) nil *myintegrator*)(a b c)(askx '?x '(r ?x) nil *myintegrator*)b(asks '?x '(r ?x) nil *myintegrator*)(b c)(resetsystem)*;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Aggregation and Dissemination and Integration;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(definemore *manager*  '((specialty myfactserver p)    (specialty myviewserver q)))*(definemore *library*  '((<= (r ?x ?z) (p ?x ?y) (q ?y ?z))))*(define-theory *myfactserver* ""  '((p a a)    (p a b)    (p a c)))*(define-theory *myviewserver* ""  '((q b c)    (q b d)))*(askx '(?x ?z) '(and (p ?x ?y) (q ?y ?z)) nil *myintegrator*)(A C)(asks '(?x ?z) '(and (p ?x ?y) (q ?y ?z)) nil *myintegrator*)((A C) (A D))(askx '(?x ?y) '(or (p ?x ?y) (q ?x ?y)) nil *myintegrator*)(A A)(asks '(?x ?y) '(or (p ?x ?y) (q ?x ?y)) nil *myintegrator*)((A A) (A B) (A C) (B C) (B D))(askx '(?x ?y) '(r ?x ?y) nil *myintegrator*)(A C)(asks '(?x ?y) '(r ?x ?y) nil *myintegrator*)((A C) (A D))(resetsystem)*;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;