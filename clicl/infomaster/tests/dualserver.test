;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; dualserver.test;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; reset;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(reset)*(defparameter *dualserver* (make-instance 'dualserver :name 'dualserver))*(defparameter *ruleserver* (make-instance 'ruleserver :name 'ruleserver))*(includes *dualserver* *ruleserver*)*;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; revise, revisions, errors, materializations, notifications, reactions;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(define-theory *dualserver* ""  '((p a b)    (p b b)    (q b b)))*(define-theory *ruleserver* ""  '((<= (r ?x ?y) (p ?x ?y) (q ?x ?y))    (<= (s ?x ?y) (p ?x ?y))    (<= (s ?x ?y) (q ?x ?y))    (<= (t ?x ?z) (p ?x ?y) (q ?y ?z))        (<= (pos (r ?x ?y)) (p ?x ?y) (not (neg (p ?x ?y))) (pos (q ?x ?y)))    (<= (pos (r ?x ?y)) (pos (p ?x ?y)) (q ?x ?y) (not (neg (q ?x ?y))))    (<= (pos (r ?x ?y)) (pos (p ?x ?y)) (pos (q ?x ?y)))    (<= (neg (r ?x ?y)) (neg (p ?x ?y)))    (<= (neg (r ?x ?y)) (neg (q ?x ?y)))    (<= (pos (s ?x ?y)) (pos (p ?x ?y)))    (<= (pos (s ?x ?y)) (pos (q ?x ?y)))    (<= (neg (s ?x ?y)) (p ?x ?y) (not (neg (p ?x ?y))) (pos (q ?x ?y)))    (<= (neg (s ?x ?y)) (pos (p ?x ?y)) (q ?x ?y) (not (neg (q ?x ?y))))    (<= (neg (s ?x ?y)) (pos (p ?x ?y)) (pos (q ?x ?y)))    (<= (plus (p ?x ?y)) (plus (r ?x ?y)))    (<= (plus (q ?x ?y)) (plus (r ?x ?y)))    (<= (minus (p ?x ?y)) (minus (r ?x ?y)) (q ?x ?y))    (<= (plus (p ?x ?y)) (plus (s ?x ?y)))    (<= (minus (p ?x ?y)) (minus (s ?x ?y)) (p ?x ?y))    (<= (minus (q ?x ?y)) (minus (s ?x ?y)) (q ?x ?y))    (<= (plus (p ?x b)) (plus (t ?x ?z)))    (<= (plus (q b ?z)) (plus (t ?x ?z)))    (<= (minus (p ?x ?y)) (minus (t ?x ?z)) (q ?y ?z))    (<= (minus (q ?y ?z)) (minus (t ?x ?z)) (p ?x ?y))    (<= (trigger (print (kwote ?x))) (pos (p ?x ?y)) (pos (q ?x ?y)))    (<= (error "P is a function.") (p ?x ?y) (not (neg (p ?x ?y))) (pos (p ?x ?z)) (distinct ?y ?z))    (<= (error "P is a function.") (pos (p ?x ?y)) (pos (p ?x ?z)) (distinct ?y ?z))))*(revisions '(p a c) *dualserver*)((P A C))(revisions '(not (p b b)) *dualserver*)((NOT (P B B)))(revisions '(and (not (p b b)) (q a b)) *dualserver*)((NOT (P B B)) (Q A B))(revisions '(r a c) *dualserver*)((P A C) (Q A C))(revisions '(s a c) *dualserver*)((P A C))(revisions '(t a c) *dualserver*)((P A B) (Q B C))(errors '(p a c) *dualserver*)("P is a function.")(errors '(and (not (p a b)) (p a c)) *dualserver*)NIL(materializations '(and (not (p b b)) (q a b)) *dualserver*)NIL(reactions '(and (p a c) (q a c)) *dualserver*)((PRINT (KWOTE A)))(reset)*;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Integers;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(integer 2) nil *dualserver*)t(askp '(integer 1/2) nil *dualserver*)nil(askp '(integer 3.2) nil *dualserver*)nil(askp '(integer #c(1 2)) nil *dualserver*)nil(askp '(integer a) nil *dualserver*)nil(askp '(even 2) nil *dualserver*)t(askp '(even a) nil *dualserver*)nil(askp '(odd 3) nil *dualserver*)t(askp '(odd a) nil *dualserver*)nil(askp '(positive 3) nil *dualserver*)t(askp '(positive a) nil *dualserver*)nil(askp '(negative -1) nil *dualserver*)t(askp '(negative a) nil *dualserver*)nil(askp '(zero 0) nil *dualserver*)t(askp '(gcd 2 6 2) nil *dualserver*)t(askp '(lcm 2 3 6) nil *dualserver*)t(askp '(isqrt 5 2) nil *dualserver*)t(askp '(mod 7 2 1) nil *dualserver*)t(askp '(rem 3 2 1) nil *dualserver*)t(askp '(ash 1 1 2) nil *dualserver*)t(askp '(boole 6 1 1 1) nil *dualserver*)t(askp '(logbit 2 6) nil *dualserver*)t(askp '(logand 1 1 1) nil *dualserver*)t(askp '(logandc1 0 1 1) nil *dualserver*)t(askp '(logandc2 1 0 1) nil *dualserver*)t(askp '(logcount 3 2) nil *dualserver*)t(askp '(logeqv 1 1 -1) nil *dualserver*)t(askp '(logior 1 1 1) nil *dualserver*)t(askp '(lognand 0 1 -1) nil *dualserver*)t(askp '(lognor 0 0 -1) nil *dualserver*)t(askp '(lognot -4 3) nil *dualserver*)t(askp '(logorc1 0 0 -1) nil *dualserver*)t(askp '(logorc2 0 0 -1) nil *dualserver*)t(askp '(logxor 0 1 1) nil *dualserver*)t(askp '(zero a) nil *dualserver*)nil(askp '(logbit 0 6) nil *dualserver*)nil(askp '(logtest 2 6) nil *dualserver*)t(askp '(logtest 2 -3) nil *dualserver*)nil;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Rationals;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(rationalnumber 1) nil *dualserver*)t(askp '(rationalnumber 1/2) nil *dualserver*)t(askp '(rationalnumber 3.2) nil *dualserver*)nil(askp '(rationalnumber #c(1 2)) nil *dualserver*)nil(askp '(rationalnumber a) nil *dualserver*)nil(askp '(numerator 1/2 1) nil *dualserver*)t(askp '(denominator 1/2 2) nil *dualserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Reals;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(realnumber 1) nil *dualserver*)t(askp '(realnumber 1/2) nil *dualserver*)t(askp '(realnumber 3.2) nil *dualserver*)t(askp '(realnumber #c(1 2)) nil *dualserver*)nil(askp '(realnumber a) nil *dualserver*)nil(askp '(< 2 3) nil *dualserver*)t(askp '(< 3 3) nil *dualserver*)nil(askp '(< a b) nil *dualserver*)nil(askp '(=< 2 3) nil *dualserver*)t(askp '(=< 3 2) nil *dualserver*)nil(askp '(=< a b) nil *dualserver*)nil(askp '(> 3 2) nil *dualserver*)t(askp '(> 3 3) nil *dualserver*)nil(askp '(> a b) nil *dualserver*)nil(askp '(>= 3 2) nil *dualserver*)t(askp '(>= 2 3) nil *dualserver*)nil(askp '(>= a b) nil *dualserver*)nil(askp '(+ 1 2 3) nil *dualserver*)t(askp '(- 3 2 1) nil *dualserver*)t(askp '(* 2 3 6) nil *dualserver*)t(askp '(/ 4 2 2) nil *dualserver*)t(askp '(1+ 1 2) nil *dualserver*)t(askp '(1- 2 1) nil *dualserver*)t(askp '(abs -1 1) nil *dualserver*)t(askp '(exp 0 1) nil *dualserver*)t(askp '(expt 2 3 8) nil *dualserver*)t(askp '(log 8 2 3) nil *dualserver*)t(askp '(sqrt 4 2) nil *dualserver*)t(askp '(max 1 2 3 3) nil *dualserver*)t(askp '(min 1 2 3 1) nil *dualserver*)t(askp '(signum 23 1) nil *dualserver*)t(askp '(acos 1 0) nil *dualserver*)t(askp '(acosh 1 0) nil *dualserver*)t(askp '(asin 0 0) nil *dualserver*)t(askp '(asinh 0 0) nil *dualserver*)t(askp '(atan 0 0) nil *dualserver*)t(askp '(atanh 0 0) nil *dualserver*)t(askp '(cos 0 1) nil *dualserver*)t(askp '(cosh 0 1) nil *dualserver*)t(askp '(sin 0 0) nil *dualserver*)t(askp '(sinh 0 0) nil *dualserver*)t(askp '(tan 0 0) nil *dualserver*)t(askp '(tanh 0 0) nil *dualserver*)t(askp '(ceiling 1.6 2) nil *dualserver*)t(askp '(floor 1.6 1) nil *dualserver*)t(askp '(round 1.6 2) nil *dualserver*)t(askp '(truncate 1.6 1) nil *dualserver*)t(askp '(rationalize 0.5 1/2) nil *dualserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Complexes;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(complexnumber 1) nil *dualserver*)nil ;;; t?(askp '(complexnumber 1/2) nil *dualserver*)nil ;;; t?(askp '(complexnumber 3.2) nil *dualserver*)nil ;;; t?(askp '(complexnumber #c(1 2)) nil *dualserver*)t(askp '(complexnumber a) nil *dualserver*)nil(askp '(conjugate #c(1 1) #c(1 -1)) nil *dualserver*)t(askp '(complex 1 1 #c(1 1)) nil *dualserver*)t(askp '(realpart #c(1 2) 1) nil *dualserver*)t(askp '(imagpart #c(1 2) 2) nil *dualserver*)t(askp '(cis 0 #c(1 0)) nil *dualserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Numbers;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(number 1) nil *dualserver*)t(askp '(number 1/2) nil *dualserver*)t(askp '(number 3.2) nil *dualserver*)t(askp '(number #c(1 2)) nil *dualserver*)t(askp '(number a) nil *dualserver*)nil;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Characters;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(character #\a) nil *dualserver*)t(askp '(character "a") nil *dualserver*)nil(askp '(character a) nil *dualserver*)nil(askp '(alphabetic #\a) nil *dualserver*)t(askp '(alphabetic #\1) nil *dualserver*)nil(askp '(uppercase #\A) nil *dualserver*)t(askp '(uppercase #\a) nil *dualserver*)nil(askp '(lowercase #\a) nil *dualserver*)t(askp '(lowercase #\A) nil *dualserver*)nil(askp '(digit #\1) nil *dualserver*)t(askp '(digit #\a) nil *dualserver*)nil(askp '(alphanumeric #\a) nil *dualserver*)t(askp '(alphanumeric #\1) nil *dualserver*)t(askp '(alphanumeric #\.) nil *dualserver*)nil(askp '(chargreater #\b #\a) nil *dualserver*)t(askp '(chargreater #\a #\b) nil *dualserver*)nil(askp '(charless #\a #\b) nil *dualserver*)t(askp '(charless #\b #\a) nil *dualserver*)nil(askp '(charupcase #\a #\A) nil *dualserver*)t(askp '(chardowncase #\A #\a) nil *dualserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Strings;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(string #\a) nil *dualserver*)nil(askp '(string "a") nil *dualserver*)t(askp '(string a) nil *dualserver*)nil(askp '(stringgreater "bbc" "abc") nil *dualserver*)t(askp '(stringgreater "abc" "bbc") nil *dualserver*)nil(askp '(stringless "abc" "bbc") nil *dualserver*)t(askp '(stringless "bbc" "abc") nil *dualserver*)nil(askp '(substring "bc" "abcd") nil *dualserver*)t(askp '(substring "abcd" "ab") nil *dualserver*)nil(askp '(stringlength "abc" 3) nil *dualserver*)t(askp '(stringelement "abc" 2 #\b) nil *dualserver*)t(askp '(stringsubseq "abcd" 2 3 "bc") nil *dualserver*)t(askp '(stringalphanumeric " a bc'd-e " "abcde") nil *dualserver*)t(askp '(stringappend "abc" "def" "ghi" "abcdefghi") nil *dualserver*)t(askp '(stringappend "" "") nil *dualserver*)t(askp '(stringcharpos #\b "abc" 2) nil *dualserver*)t(askx '?x '(stringcharpos #\d "abc" ?x) nil *dualserver*)nil(askp '(stringposition "bc" "abcd" 2) nil *dualserver*)t(askx '?x '(stringposition "cb" "abcd" ?x) nil *dualserver*)nil(askp '(stringsubstitute #\a #\b "abab" "aaaa") nil *dualserver*)t(askp '(stringupcase "abc" "ABC") nil *dualserver*)t(askp '(stringdowncase "ABC" "abc") nil *dualserver*)t(askp '(stringcapitalize "abc.def" "Abc.Def") nil *dualserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Conversion;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(charstring #\a "a") nil *dualserver*)t(askp '(stringify a "A") nil *dualserver*)t(askp '(symbolize "a" a) nil *dualserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Miscellaneous;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(word 'a) nil *dualserver*)t(askp '(word a) nil *dualserver*)nil(askp '(indvar '?x) nil *dualserver*)t(askp '(indvar a) nil *dualserver*)nil(askp '(seqvar '@l) nil *dualserver*)t(askp '(seqvar a) nil *dualserver*)nil(askp '(variable '?x) nil *dualserver*)t(askp '(variable '@l) nil *dualserver*)t(askp '(variable a) nil *dualserver*)nil(askp '(same a a) nil *dualserver*)t(askp '(same a b) nil *dualserver*)nil(askp '(distinct a a) nil *dualserver*)nil(askp '(distinct a b) nil *dualserver*)t(askp '(oneof b a b c) nil *dualserver*)t(askp '(oneof d a b c) nil *dualserver*)nil(askp '(choose ?x (oneof ?x a b c) a) nil *dualserver*)t(askp '(choose ?x (oneof ?x a b c) b) nil *dualserver*)nil(askp '(bagofall ?x (oneof ?x a b c) (listof a b c)) nil *dualserver*)t(askp '(bagofall ?x (oneof ?x a b c) (listof a)) nil *dualserver*)nil(askp '(ground a) nil *dualserver*)t(askp '(ground ?x) nil *dualserver*)nil(askp '(nonground a) nil *dualserver*)nil(askp '(nonground ?x) nil *dualserver*)t(askp '(execute (member 'b '(a b c)) '(b c)) nil *dualserver*)t(askp '(evaluate (member b (a b c)) (b c)) nil *dualserver*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Logic;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp 'true nil *dualserver*)t(askp 'false nil *dualserver*)nil(askp '(not true) nil *dualserver*)nil(askp '(not false) nil *dualserver*)t(askp '(and true true) nil *dualserver*)t(askp '(and true false) nil *dualserver*)nil(askp '(and false true) nil *dualserver*)nil(askp '(and false false) nil *dualserver*)nil(askp '(or true true) nil *dualserver*)t(askp '(or true false) nil *dualserver*)t(askp '(or false true) nil *dualserver*)t(askp '(or false false) nil *dualserver*)nil;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Inference;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(define-theory *dualserver* ""  '((p a)    (p b)    (p c)    (q b)    (q c)))*(askp '(and (p b) (q b)) nil *dualserver*)t(askp '(or (p a) (q a)) nil *dualserver*)t(askx '?x '(and (p ?x) (q ?x)) nil *dualserver*)b(askx '?x '(or (p ?x) (q ?x)) nil *dualserver*)a(asks '?x '(and (p ?x) (q ?x)) nil *dualserver*)(b c)(asks '?x '(or (p ?x) (q ?x)) nil *dualserver*)(a b c)(define-theory *dualserver* ""  '((pp a a)    (pp a b)    (qq b c)))*(askp '(and (pp a b) (qq b c)) nil *dualserver*)t(askx '(?x ?y ?z) '(and (pp ?x ?y) (qq ?y ?z)) nil *dualserver*)(a b c)(asks '(?x ?y ?z) '(and (pp ?x ?y) (qq ?y ?z)) nil *dualserver*)((a b c))(reset)*;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;