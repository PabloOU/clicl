var gMenu = null;var gCal = null;var gColorPicker = null;var gSelectedItem = null;var gSelectedCell = null;var gIsGecko = false;var gIsOpera = false;var gIsSafari = null;var gIsBrowserKnown = false;var preloadImage = new Image();var gMonths = [  {name: 'January', days: 31},  {name: 'February', days: 28},  {name: 'March', days: 31},  {name: 'April', days: 30},  {name: 'May', days: 31},  {name: 'June', days: 30},  {name: 'July', days: 31},  {name: 'August', days: 31},  {name: 'September', days: 30},  {name: 'October', days: 31},  {name: 'November', days: 30},  {name: 'December', days: 31}];var textchange = false;var http_result = false;function postAnother (fobj,index) {postRequest(fobj.action,'Structure=' + anotherStructure(fobj,index) + '&Command=Refresh')}function postRemoval (fobj,index) {postRequest(fobj.action,'Structure=' + removalStructure(fobj,index) + '&Command=Refresh')}function postReplace (fobj) {postRequest(fobj.action,'Structure=' + newFormStructure(fobj) + '&Command=Refresh')}function postDisplay (fobj) {window.location = fobj.action + 'Structure=' + newFormStructure(fobj) + '&Command=Display'}function postRequest (url,args) {http_result = false;  if (window.XMLHttpRequest)     {http_result = new XMLHttpRequest();      if (http_result.overrideMimeType)         {http_result.overrideMimeType('text/xml');}}  else if (window.ActiveXObject)          {try {http_result = new ActiveXObject('Msxml2.XMLHTTP')}           catch (e) {try {http_result = new ActiveXObject('Microsoft.XMLHTTP')}                      catch (e) {} }};  http_result.onreadystatechange = alertRequest;  http_result.open('POST', url, true);  http_result.send(args)}function alertRequest() {if (http_result.readyState == 4)     {if (http_result.responseText)         {document.documentElement.innerHTML=http_result.responseText}      else {alert('There was a problem with the request in alertResult.')}}}function newFormStructure (fobj) {var str = '';  str += '(' + fobj.elements[0].value;  str += ' ' + fobj.elements[1].value;  for (var i = 2; i < fobj.elements.length; i++)      {if (fobj.elements[i].status == 'skip') {str = str}       else if (fobj.elements[i].type == 'select-one')               {var val = fobj.elements[i].options[fobj.elements[i].selectedIndex].value;                str += ' ' + listify(fobj.elements[i].name, val)}       else if (fobj.elements[i].type == 'select-multiple')               {for (var j = 0; j < fobj.elements[i].options.length; j++)                    {if (fobj.elements[i].options[j].selected)                        {var val = fobj.elements[i].options[j].value;                         str += ' ' + listify(fobj.elements[i].name, val)}}}       else if (fobj.elements[i].type == 'radio')               {if (fobj.elements[i].checked)                   {str += ' ' + listify(fobj.elements[i].name, escape(fobj.elements[i].value))}}       else if (fobj.elements[i].type == 'checkbox')               {if (fobj.elements[i].checked)                   {str += ' ' + listify(fobj.elements[i].name, escape(fobj.elements[i].value))}}       else if (fobj.elements[i].type == 'button')               {str = str}       else if (fobj.elements[i].status == 'string')               {if (fobj.elements[i].value == '')                   {str +=  ' ' + listify(fobj.elements[i].name, '')}                else {str += ' ' + listify(fobj.elements[i].name, stringize(fobj.elements[i].value))}}       else {str += ' ' + listify(fobj.elements[i].name, escape(fobj.elements[i].value))}}  str = str + ')';  return str}function anotherStructure (fobj,ind) {var str = '';  str += '(' + fobj.elements[0].value;  str += ' ' + fobj.elements[1].value;  for (var i = 2; i < fobj.elements.length; i++)      {if (fobj.elements[i].status == 'skip') {str = str}       else if (fobj.elements[i].type == 'select-one')               {var val = fobj.elements[i].options[fobj.elements[i].selectedIndex].value;                str += ' ' + listify(fobj.elements[i].name,val);                if (fobj.elements[i].getAttribute('index') == ind)                   {str += ' ' + listify(fobj.elements[i].name, '')}}       else if (fobj.elements[i].type == 'select-multiple')               {for (var j = 0; j < fobj.elements[i].options.length; j++)                    {if (fobj.elements[i].options[j].selected)                        {var val = fobj.elements[i].options[j].value;                         str += ' ' + listify(fobj.elements[i].name, val)}}}       else if (fobj.elements[i].type == 'radio')               {if (fobj.elements[i].checked)                   {str += ' ' + listify(fobj.elements[i].name, escape(fobj.elements[i].value))}}       else if (fobj.elements[i].type == 'checkbox')               {if (fobj.elements[i].checked)                   {str += ' ' + listify(fobj.elements[i].name, escape(fobj.elements[i].value))}}       else if (fobj.elements[i].type == 'button')               {str = str}       else if (fobj.elements[i].status == 'string')               {if (fobj.elements[i].value == '')                   {str +=  ' ' + listify(fobj.elements[i].name, '')}                else {str += ' ' + listify(fobj.elements[i].name, stringize(fobj.elements[i].value))};                if (fobj.elements[i].getAttribute('index') == ind)                   {str += ' ' + listify(fobj.elements[i].name, '')}}       else {str += ' ' + listify(fobj.elements[i].name, escape(fobj.elements[i].value));             if (fobj.elements[i].getAttribute('index') == ind)                 {str += ' ' + listify(fobj.elements[i].name, '')}}}  str = str + ')';  return str}function removalStructure (fobj,ind) {var str = '';  str += '(' + fobj.elements[0].value;  str += ' ' + fobj.elements[1].value;  for (var i = 2; i < fobj.elements.length; i++)      {if (fobj.elements[i].status == 'skip') {str = str}       else if (fobj.elements[i].index == ind) {str = str}       else if (fobj.elements[i].type == 'button') {str = str}       else if (fobj.elements[i].type == 'select-one')               {if (fobj.elements[i].getAttribute('index') != ind)                   {var val = fobj.elements[i].options[fobj.elements[i].selectedIndex].value;                    str += ' ' + listify(fobj.elements[i].name, val)}}       else if (fobj.elements[i].type == 'select-multiple')               {for (var j = 0; j < fobj.elements[i].options.length; j++)                    {if (fobj.elements[i].options[j].selected)                        {var val = fobj.elements[i].options[j].value;                         str += ' ' + listify(fobj.elements[i].name, val)}}}       else if (fobj.elements[i].type == 'radio')               {if (fobj.elements[i].checked)                   {str += ' ' + listify(fobj.elements[i].name, escape(fobj.elements[i].value))}}       else if (fobj.elements[i].type == 'checkbox')               {if (fobj.elements[i].checked)                   {str += ' ' + listify(fobj.elements[i].name, escape(fobj.elements[i].value))}}       else if (fobj.elements[i].status == 'string')               {if (fobj.elements[i].getAttribute('index') != ind && fobj.elements[i].value == '')                   {str +=  ' ' + listify(fobj.elements[i].name, '')}                else {str += ' ' + listify(fobj.elements[i].name, stringize(fobj.elements[i].value))}}       else if (fobj.elements[i].getAttribute('index') != ind)               {str += ' ' + listify(fobj.elements[i].name, escape(fobj.elements[i].value))}}  str = str + ')';  return str}function stringize (str)  {str = str.replace(/\\\\/g,'\\\\\\\\');   str = str.replace(/\"/g,'\\\\\\\"');   return '\"' + escape(str) + '\"'}function listify (x, y)  {return '(' + x + ' ' + y + ')'}function textEdit(e) {var keynum;  if (window.event) {keynum = e.keyCode}  else if (e.which) {keynum = e.which};  if (keynum == 13)     {textchange = false;      postReplace(form1);      return false}  else {textchange = true;        return true}}function textBlur(e) {if (textchange == true)     {textchange = false;      postReplace(form1)}}function oldCheckNumber (evt,value) {var code = GetCharCode(evt);  if (IsMetaKeyDown(evt) || IsAltKeyDown(evt) || IsCtrlKeyDown(evt)) {return true}  if ((code==null) || (code==0) || (code==8) || (code==9) || (code==27) || (code >= 37 && code <= 40) || (code > 255)) {return true}  else if (code >= 48 && code <= 57) {return true}  else if (((code == 190) || (code == 46)) && value.indexOf('.') == -1) {return true}  return false}function newCheckNumber (evt,value) {var code = GetCharCode(evt);  if (IsMetaKeyDown(evt) || IsAltKeyDown(evt) || IsCtrlKeyDown(evt)) {return true}  if (code == 13) {postReplace(form1); return false};  if ((code==null) || (code==0) || (code==8) || (code==9) || (code==27) || (code >= 37 && code <= 40) || (code > 255)) {return true}  else if (code >= 48 && code <= 57) {return true}  else if (((code == 190) || (code == 46)) && value.indexOf('.') == -1) {return true}  return false}function DetermineBrowser() {if(gIsBrowserKnown) return;  gIsBrowserKnown=true;  var ua=navigator.userAgent.toLowerCase();  gIsGecko=((ua.indexOf('gecko')!=-1)&&(ua.indexOf('opera')==-1));  gIsOpera=(ua.indexOf('opera')!=-1);  gIsSafari=(ua.indexOf('safari')!=-1)}function IsGecko () {DetermineBrowser();  return gIsGecko}function IsSafari () {DetermineBrowser();  return gIsSafari}function Min (a,b) {if (a < b) return a;  return b}function IsMetaKeyDown (evt) {if (!evt) evt=window.event;  if (evt) {return evt.metaKey}  return false}function IsShiftKeyDown (evt) {if (!evt) evt=window.event;  if (evt) {return evt.shiftKey}  return false}function IsAltKeyDown (evt) {if (!evt) evt=window.event;  if (evt) {return evt.altKey}  return false}function IsCtrlKeyDown (evt) {if (!evt) evt=window.event;  if (evt) {return evt.ctrlKey}  return false}function GetCharCode (evt) {if (!evt) evt=window.event;  if (evt)     {if (evt.keyCode) {return evt.keyCode}      else {return evt.which}}  return 0}function HandleKeyDown (evt) {var code = GetCharCode(evt);  if (code == 9 || code == 0) {hidePopup()}  return true}function numChildNodes (elt) {var nodes = elt.childNodes;  var n = 0;  for (i=0; i < nodes.length; i=i+1)      {if(nodes[i].nodeType == 1) {n = n+1}}  return n}//------------------------------------------------------------------------------// combobox//------------------------------------------------------------------------------function showMenu (elt) {hidePopup();  gMenu = elt;  var numElts = numChildNodes(elt);  if (numElts > 0) {elt.style.display='block'}}function hideMenu () {if (gMenu != null) {gMenu.style.display='none'; gMenu = null};  comboDeselect()}function comboSelect (elt) {if (elt != gSelectedItem)     {comboDeselect();      gSelectedItem = elt;      elt.style.color='white';      elt.style.backgroundColor='#316AC5'}}function comboDeselect () {if (gSelectedItem)     {gSelectedItem.style.color='';      gSelectedItem.style.backgroundColor='';      gSelectedItem = null}}function cbClick (elt,val,evt) {elt.parentNode.previousSibling.value=val;  hidePopup();  cancelBubble(evt)}//------------------------------------------------------------------------------// dateinput//------------------------------------------------------------------------------function showCal (cal,date) {hidePopup();  gCal = cal;  cal.style.display='block';  date = parseDate(date);  if(!date) date = new Date();  var month = date.getMonth()+1;  var year = date.getFullYear();  var day = date.getDate();  selectCell(year,month,day,cal)}function hideCal () {if (gCal != null) {gCal.style.display='none'} else {gCal = null}}function prevMonth(elt,evt) {cal = elt.parentNode.parentNode.parentNode.parentNode;  selectCell(parseInt(cal.childNodes[1].value), parseInt(cal.childNodes[0].value), 0,cal);  cancelBubble(evt)}function nextMonth(elt,evt) {cal = elt.parentNode.parentNode.parentNode.parentNode;  selectCell(parseInt(cal.childNodes[3].value), parseInt(cal.childNodes[2].value), 0,cal);  cancelBubble(evt)}function calClick (val,evt) {gCal.previousSibling.value=val;  //postReplace(form1);  hidePopup();  cancelBubble(evt)}function parseDate(d) {d = d.split('/');   if(d.length != 3 || d[0].length == 0 || d[1].length == 0 || d[0].length > 2 || d[1].length > 2 || d[2].length != 4) return null;   d[0] = parseInt(d[0]);   d[1] = parseInt(d[1]);   d[2] = parseInt(d[2]);   if (isNaN(d[0]) || isNaN(d[1]) || isNaN(d[2])) return null;   if (d[0] < 1 || d[0] > 12 || d[1] < 1 || d[1] > 31) return null;   return new Date(d[2],d[0]-1,d[1])}function selectCell (year,month,day,cal) {var monthIndex = month-1;  gMonths[1].days = ((year % 4 == 0 && year % 100 != 0) || year % 400 == 0) ? 29 : 28;  var prevYear = (month == 1) ? year - 1 : year;  var nextYear = (month == 12) ? year + 1 : year;  var prevMonth = (month == 1) ? 12 : month - 1;  var nextMonth = month % 12 + 1;  var firstDay = new Date ();  firstDay.setFullYear(year,monthIndex,1);  firstDay = firstDay.getDay();  var monthName = gMonths[monthIndex].name;  var numDays = gMonths[monthIndex].days;  var prevDays = gMonths[prevMonth-1].days;  var numPrevDays = (firstDay > 4) ? firstDay : firstDay + 7;  cal.childNodes[0].value = prevMonth;  cal.childNodes[1].value = prevYear;  cal.childNodes[2].value = nextMonth;  cal.childNodes[3].value = nextYear;  var table = cal.childNodes[4];  table.childNodes[0].childNodes[0].childNodes[1].childNodes[0].innerHTML=monthName;  table.childNodes[0].childNodes[0].childNodes[1].childNodes[1].innerHTML=' ' + year;  var d = prevDays - numPrevDays + 1;  var m = prevMonth;  var y = prevYear;  for (var r = 2; r < 9; r++)      {var row = table.rows[r];       for (var c = 0; c < 7; c++)           {var cell = row.cells[c];            cell.innerHTML = d;            cell.id = m + '/' + d + '/' + y;            cell.style.fontWeight = (m == month) ? 'bold' : '';            if (d == day && m == month && y == year)               {cell.style.backgroundColor = (c == 0 || c == 6) ? '#9bd' : '#ace'}            else {cell.style.backgroundColor = ''};       d++;       if (m == prevMonth && d > prevDays)          {m = month; d = 1; y = year}       else if (m == month && d > numDays)            {m = nextMonth; d = 1; y = nextYear}}}}//------------------------------------------------------------------------------// colorpicker//------------------------------------------------------------------------------function showColorPicker(elem,evt) {cancelBubble(evt);  hidePopup();  gColorPicker = elem.nextSibling;  gColorPicker.style.display='block'}function hideColorPicker () {if (gColorPicker != null)     {gColorPicker.style.display='none';      gColorPicker = null}}function cpClicked (val,evt) {gColorPicker.previousSibling.previousSibling.value=val;  hidePopup();  cancelBubble(evt)}//------------------------------------------------------------------------------// Other Subroutines//------------------------------------------------------------------------------function CancelBubble(evt){    if(!evt) evt=window.event;    if(evt) {        if (evt.stopPropagation) evt.stopPropagation();        if (evt.preventDefault) evt.preventDefault();        if (evt.preventBubble) evt.preventBubble();        evt.returnValue=false;        evt.cancelBubble=true;    }    return false;}function cancelBubble(evt) {if(!evt) evt=window.event;  if (evt)     {if (evt.stopPropagation) evt.stopPropagation();      if (evt.preventDefault) evt.preventDefault();     //   if (evt.preventBubble) evt.preventBubble();      evt.returnValue=false;      evt.cancelBubble=true}    return false}function getElementBy(ele_str) {var elem=document.getElementById(ele_str);  if (elem) return elem;  var elt=document.getElementsByName(ele_str);  if (elt.length>0) return elt[0];  return null}function toElem(ele) {if(!ele) return ele;  if(typeof ele=='string')    {return getElementBy(ele)}  else {return ele}}function EltBox(ele) {ele=toElem(ele);    var box=new Object;    var lft=0;    var top=0;    for (var e=ele; e; e=e.offsetParent)        {lft += e.offsetLeft;         top += e.offsetTop;         if (!IsGecko())            {lft+=e.clientLeft;             top+=e.clientTop}}    box.left = lft;    box.top = top;    box.right = lft + ele.offsetWidth;    box.bottom = top + ele.offsetHeight;    return box}function hidePopup() {hideMenu();  hideCal();  hideColorPicker()}