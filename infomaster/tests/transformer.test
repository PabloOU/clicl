;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; transformer.test;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; resetsystem;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(resetsystem)*;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; revise, revisions;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(definemore *manager*  '((extension mytransformer p)    (extension mytransformer q)    (material  mytransformer r)    (specialty repository p)    (specialty repository q)    (interest  mrg        p)    (interest  mrg        r)))*(definemore *repository*  '((p a b)    (p b b)    (q b b)))*(define-theory *library* ""  '((<= (r ?x ?y) (p ?x ?y) (q ?x ?y))    (<= (s ?x ?y) (p ?x ?y))    (<= (s ?x ?y) (q ?x ?y))    (<= (t ?x ?z) (p ?x ?y) (q ?y ?z))        (<= (pos (r ?x ?y)) (p ?x ?y) (not (neg (p ?x ?y))) (pos (q ?x ?y)))    (<= (pos (r ?x ?y)) (pos (p ?x ?y)) (q ?x ?y) (not (neg (q ?x ?y))))    (<= (pos (r ?x ?y)) (pos (p ?x ?y)) (pos (q ?x ?y)))    (<= (neg (r ?x ?y)) (neg (p ?x ?y)))    (<= (neg (r ?x ?y)) (neg (q ?x ?y)))    (<= (pos (s ?x ?y)) (pos (p ?x ?y)))    (<= (pos (s ?x ?y)) (pos (q ?x ?y)))    (<= (neg (s ?x ?y)) (p ?x ?y) (not (neg (p ?x ?y))) (pos (q ?x ?y)))    (<= (neg (s ?x ?y)) (pos (p ?x ?y)) (q ?x ?y) (not (neg (q ?x ?y))))    (<= (neg (s ?x ?y)) (pos (p ?x ?y)) (pos (q ?x ?y)))    (<= (plus (p ?x ?y)) (plus (r ?x ?y)))    (<= (plus (q ?x ?y)) (plus (r ?x ?y)))    (<= (minus (p ?x ?y)) (minus (r ?x ?y)) (q ?x ?y))    (<= (plus (p ?x ?y)) (plus (s ?x ?y)))    (<= (minus (p ?x ?y)) (minus (s ?x ?y)) (p ?x ?y))    (<= (minus (q ?x ?y)) (minus (s ?x ?y)) (q ?x ?y))    (<= (plus (p ?x b)) (plus (t ?x ?z)))    (<= (plus (q b ?z)) (plus (t ?x ?z)))    (<= (minus (p ?x ?y)) (minus (t ?x ?z)) (q ?y ?z))    (<= (minus (q ?y ?z)) (minus (t ?x ?z)) (p ?x ?y))    (<= (trigger (print (kwote ?x))) (pos (p ?x ?y)) (pos (q ?x ?y)))    (<= (error "P is a function.") (p ?x ?y) (not (neg (p ?x ?y))) (pos (p ?x ?z)) (distinct ?y ?z))    (<= (error "P is a function.") (pos (p ?x ?y)) (pos (p ?x ?z)) (distinct ?y ?z))))*(revisions '(p a c) *mytransformer*)((P A C))(revisions '(not (p b b)) *mytransformer*)((NOT (P B B)))(revisions '(and (not (p b b)) (q a b)) *mytransformer*)((NOT (P B B)) (Q A B))(revisions '(r a c) *mytransformer*)((P A C) (Q A C))(revisions '(s a c) *mytransformer*)((P A C))(revisions '(t a c) *mytransformer*)((P A B) (Q B C))(errors '(p a c) *mytransformer*)("P is a function.")(errors '(and (not (p a b)) (p a c)) *mytransformer*)NIL(materializations '(and (not (p b b)) (q a b)) *mytransformer*)((NOT (R B B)) (R A B))(reactions '(and (p a c) (q a c)) *mytransformer*)((PRINT (KWOTE A)))(resetsystem)*;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Integers;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(integer 2) nil *mytransformer*)t(askp '(integer 1/2) nil *mytransformer*)nil(askp '(integer 3.2) nil *mytransformer*)nil(askp '(integer #c(1 2)) nil *mytransformer*)nil(askp '(integer a) nil *mytransformer*)nil(askp '(even 2) nil *mytransformer*)t(askp '(even a) nil *mytransformer*)nil(askp '(odd 3) nil *mytransformer*)t(askp '(odd a) nil *mytransformer*)nil(askp '(positive 3) nil *mytransformer*)t(askp '(positive a) nil *mytransformer*)nil(askp '(negative -1) nil *mytransformer*)t(askp '(negative a) nil *mytransformer*)nil(askp '(zero 0) nil *mytransformer*)t(askp '(gcd 2 6 2) nil *mytransformer*)t(askp '(lcm 2 3 6) nil *mytransformer*)t(askp '(isqrt 5 2) nil *mytransformer*)t(askp '(mod 7 2 1) nil *mytransformer*)t(askp '(rem 3 2 1) nil *mytransformer*)t(askp '(ash 1 1 2) nil *mytransformer*)t(askp '(boole 6 1 1 1) nil *mytransformer*)t(askp '(logbit 2 6) nil *mytransformer*)t(askp '(logand 1 1 1) nil *mytransformer*)t(askp '(logandc1 0 1 1) nil *mytransformer*)t(askp '(logandc2 1 0 1) nil *mytransformer*)t(askp '(logcount 3 2) nil *mytransformer*)t(askp '(logeqv 1 1 -1) nil *mytransformer*)t(askp '(logior 1 1 1) nil *mytransformer*)t(askp '(lognand 0 1 -1) nil *mytransformer*)t(askp '(lognor 0 0 -1) nil *mytransformer*)t(askp '(lognot -4 3) nil *mytransformer*)t(askp '(logorc1 0 0 -1) nil *mytransformer*)t(askp '(logorc2 0 0 -1) nil *mytransformer*)t(askp '(logxor 0 1 1) nil *mytransformer*)t(askp '(zero a) nil *mytransformer*)nil(askp '(logbit 0 6) nil *mytransformer*)nil(askp '(logtest 2 6) nil *mytransformer*)t(askp '(logtest 2 -3) nil *mytransformer*)nil;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Rationals;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(rationalnumber 1) nil *mytransformer*)t(askp '(rationalnumber 1/2) nil *mytransformer*)t(askp '(rationalnumber 3.2) nil *mytransformer*)nil(askp '(rationalnumber #c(1 2)) nil *mytransformer*)nil(askp '(rationalnumber a) nil *mytransformer*)nil(askp '(numerator 1/2 1) nil *mytransformer*)t(askp '(denominator 1/2 2) nil *mytransformer*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Reals;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(realnumber 1) nil *mytransformer*)t(askp '(realnumber 1/2) nil *mytransformer*)t(askp '(realnumber 3.2) nil *mytransformer*)t(askp '(realnumber #c(1 2)) nil *mytransformer*)nil(askp '(realnumber a) nil *mytransformer*)nil(askp '(< 2 3) nil *mytransformer*)t(askp '(< 3 3) nil *mytransformer*)nil(askp '(< a b) nil *mytransformer*)nil(askp '(=< 2 3) nil *mytransformer*)t(askp '(=< 3 2) nil *mytransformer*)nil(askp '(=< a b) nil *mytransformer*)nil(askp '(> 3 2) nil *mytransformer*)t(askp '(> 3 3) nil *mytransformer*)nil(askp '(> a b) nil *mytransformer*)nil(askp '(>= 3 2) nil *mytransformer*)t(askp '(>= 2 3) nil *mytransformer*)nil(askp '(>= a b) nil *mytransformer*)nil(askp '(+ 1 2 3) nil *mytransformer*)t(askp '(- 3 2 1) nil *mytransformer*)t(askp '(* 2 3 6) nil *mytransformer*)t(askp '(/ 4 2 2) nil *mytransformer*)t(askp '(1+ 1 2) nil *mytransformer*)t(askp '(1- 2 1) nil *mytransformer*)t(askp '(abs -1 1) nil *mytransformer*)t(askp '(exp 0 1) nil *mytransformer*)t(askp '(expt 2 3 8) nil *mytransformer*)t(askp '(log 8 2 3) nil *mytransformer*)t(askp '(sqrt 4 2) nil *mytransformer*)t(askp '(max 1 2 3 3) nil *mytransformer*)t(askp '(min 1 2 3 1) nil *mytransformer*)t(askp '(signum 23 1) nil *mytransformer*)t(askp '(acos 1 0) nil *mytransformer*)t(askp '(acosh 1 0) nil *mytransformer*)t(askp '(asin 0 0) nil *mytransformer*)t(askp '(asinh 0 0) nil *mytransformer*)t(askp '(atan 0 0) nil *mytransformer*)t(askp '(atanh 0 0) nil *mytransformer*)t(askp '(cos 0 1) nil *mytransformer*)t(askp '(cosh 0 1) nil *mytransformer*)t(askp '(sin 0 0) nil *mytransformer*)t(askp '(sinh 0 0) nil *mytransformer*)t(askp '(tan 0 0) nil *mytransformer*)t(askp '(tanh 0 0) nil *mytransformer*)t(askp '(ceiling 1.6 2) nil *mytransformer*)t(askp '(floor 1.6 1) nil *mytransformer*)t(askp '(round 1.6 2) nil *mytransformer*)t(askp '(truncate 1.6 1) nil *mytransformer*)t(askp '(rationalize 0.5 1/2) nil *mytransformer*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Complexes;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(complexnumber 1) nil *mytransformer*)nil ;;; t?(askp '(complexnumber 1/2) nil *mytransformer*)nil ;;; t?(askp '(complexnumber 3.2) nil *mytransformer*)nil ;;; t?(askp '(complexnumber #c(1 2)) nil *mytransformer*)t(askp '(complexnumber a) nil *mytransformer*)nil(askp '(conjugate #c(1 1) #c(1 -1)) nil *mytransformer*)t(askp '(complex 1 1 #c(1 1)) nil *mytransformer*)t(askp '(realpart #c(1 2) 1) nil *mytransformer*)t(askp '(imagpart #c(1 2) 2) nil *mytransformer*)t(askp '(cis 0 #c(1 0)) nil *mytransformer*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Numbers;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(number 1) nil *mytransformer*)t(askp '(number 1/2) nil *mytransformer*)t(askp '(number 3.2) nil *mytransformer*)t(askp '(number #c(1 2)) nil *mytransformer*)t(askp '(number a) nil *mytransformer*)nil;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Characters;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(character #\a) nil *mytransformer*)t(askp '(character "a") nil *mytransformer*)nil(askp '(character a) nil *mytransformer*)nil(askp '(alphabetic #\a) nil *mytransformer*)t(askp '(alphabetic #\1) nil *mytransformer*)nil(askp '(uppercase #\A) nil *mytransformer*)t(askp '(uppercase #\a) nil *mytransformer*)nil(askp '(lowercase #\a) nil *mytransformer*)t(askp '(lowercase #\A) nil *mytransformer*)nil(askp '(digit #\1) nil *mytransformer*)t(askp '(digit #\a) nil *mytransformer*)nil(askp '(alphanumeric #\a) nil *mytransformer*)t(askp '(alphanumeric #\1) nil *mytransformer*)t(askp '(alphanumeric #\.) nil *mytransformer*)nil(askp '(chargreater #\b #\a) nil *mytransformer*)t(askp '(chargreater #\a #\b) nil *mytransformer*)nil(askp '(charless #\a #\b) nil *mytransformer*)t(askp '(charless #\b #\a) nil *mytransformer*)nil(askp '(charupcase #\a #\A) nil *mytransformer*)t(askp '(chardowncase #\A #\a) nil *mytransformer*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Strings;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(string #\a) nil *mytransformer*)nil(askp '(string "a") nil *mytransformer*)t(askp '(string a) nil *mytransformer*)nil(askp '(stringgreater "bbc" "abc") nil *mytransformer*)t(askp '(stringgreater "abc" "bbc") nil *mytransformer*)nil(askp '(stringless "abc" "bbc") nil *mytransformer*)t(askp '(stringless "bbc" "abc") nil *mytransformer*)nil(askp '(substring "bc" "abcd") nil *mytransformer*)t(askp '(substring "abcd" "ab") nil *mytransformer*)nil(askp '(stringlength "abc" 3) nil *mytransformer*)t(askp '(stringelement "abc" 2 #\b) nil *mytransformer*)t(askp '(stringsubseq "abcd" 2 3 "bc") nil *mytransformer*)t(askp '(stringalphanumeric " a bc'd-e " "abcde") nil *mytransformer*)t(askp '(stringappend "abc" "def" "ghi" "abcdefghi") nil *mytransformer*)t(askp '(stringappend "" "") nil *mytransformer*)t(askp '(stringcharpos #\b "abc" 2) nil *mytransformer*)t(askx '?x '(stringcharpos #\d "abc" ?x) nil *mytransformer*)nil(askp '(stringposition "bc" "abcd" 2) nil *mytransformer*)t(askx '?x '(stringposition "cb" "abcd" ?x) nil *mytransformer*)nil(askp '(stringsubstitute #\a #\b "abab" "aaaa") nil *mytransformer*)t(askp '(stringupcase "abc" "ABC") nil *mytransformer*)t(askp '(stringdowncase "ABC" "abc") nil *mytransformer*)t(askp '(stringcapitalize "abc.def" "Abc.Def") nil *mytransformer*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Conversion;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(charstring #\a "a") nil *mytransformer*)t(askp '(stringify a "A") nil *mytransformer*)t(askp '(symbolize "a" a) nil *mytransformer*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Miscellaneous;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(askp '(word 'a) nil *mytransformer*)t(askp '(word a) nil *mytransformer*)nil(askp '(indvar '?x) nil *mytransformer*)t(askp '(indvar a) nil *mytransformer*)nil(askp '(seqvar '@l) nil *mytransformer*)t(askp '(seqvar a) nil *mytransformer*)nil(askp '(variable '?x) nil *mytransformer*)t(askp '(variable '@l) nil *mytransformer*)t(askp '(variable a) nil *mytransformer*)nil(askp '(same a a) nil *mytransformer*)t(askp '(same a b) nil *mytransformer*)nil(askp '(distinct a a) nil *mytransformer*)nil(askp '(distinct a b) nil *mytransformer*)t(askp '(oneof b a b c) nil *mytransformer*)t(askp '(oneof d a b c) nil *mytransformer*)nil(askp '(choose ?x (oneof ?x a b c) a) nil *mytransformer*)t(askp '(choose ?x (oneof ?x a b c) b) nil *mytransformer*)nil(askp '(bagofall ?x (oneof ?x a b c) (listof a b c)) nil *mytransformer*)t(askp '(bagofall ?x (oneof ?x a b c) (listof a)) nil *mytransformer*)nil(askp '(ground a) nil *mytransformer*)t(askp '(ground ?x) nil *mytransformer*)nil(askp '(nonground a) nil *mytransformer*)nil(askp '(nonground ?x) nil *mytransformer*)t(askp '(execute (member 'b '(a b c)) '(b c)) nil *mytransformer*)t(askp '(evaluate (member b (a b c)) (b c)) nil *mytransformer*)t;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Logic;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(request '(ask-if true) nil *mytransformer*)t(request '(ask-if false) nil *mytransformer*)nil(request '(ask-if (not true)) nil *mytransformer*)nil(request '(ask-if (not false)) nil *mytransformer*)t(request '(ask-if (and true true)) nil *mytransformer*)t(request '(ask-if (and true false)) nil *mytransformer*)nil(request '(ask-if (and false true)) nil *mytransformer*)nil(request '(ask-if (and false false)) nil *mytransformer*)nil(request '(ask-if (or true true)) nil *mytransformer*)t(request '(ask-if (or true false)) nil *mytransformer*)t(request '(ask-if (or false true)) nil *mytransformer*)t(request '(ask-if (or false false)) nil *mytransformer*)nil;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; Transformation;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;(definemore *manager*  '((specialty repository p)    (specialty repository q)))*(definemore *library*  '((<= (r ?x) (p ?x) (q ?x))))*(define-theory *repository* ""  '((p a)    (p b)    (p c)    (q b)    (q c)))*(request '(ask-one ?x (and (p ?x) (q ?x))) nil *mytransformer*)b(request '(ask-all ?x (and (p ?x) (q ?x))) nil *mytransformer*)(b c)(request '(ask-one ?x (or (p ?x) (q ?x))) nil *mytransformer*)a(request '(ask-all ?x (or (p ?x) (q ?x))) nil *mytransformer*)(a b c)(request '(ask-one ?x (r ?x)) nil *mytransformer*)b(request '(ask-all ?x (r ?x)) nil *mytransformer*)(b c)(resetsystem)*;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;